<style>
 /*
 strong {
    color: #666;
    font-weight: bold;
    padding-left: 1.5em;
    background: transparent url(http://www.vimer.cn/static/zinnia/theme/img/shorturl.png) no-repeat scroll;
 }*/

 .post-content h2,
 .post-content h3,
 .post-content h4,
 .post-content h5,
 .post-content h6,
 .post-content h7,
 .post-content a {
    border: none !important;
  }

 .post-content p {
     margin-bottom: 15px !important;
     text-align: justify;
 }

 .post-content ul {
     list-style-type: square !important;
 }
 
 .post-content abbr, 
 .post-content acronym, 
 .post-content address, 
 .post-content applet, 
 .post-content big, 
 .post-content caption,
 .post-content cite,
 .post-content code, 
 .post-content del, 
 .post-content dfn, 
 .post-content em, 
 .post-content fieldset, 
 .post-content figure,
 .post-content font, 
 .post-content form, 
 .post-content iframe,
 .post-content ins, 
 .post-content kbd, 
 .post-content label, 
 .post-content legend, 
 .post-content object, 
 .post-content pre, 
 .post-content q, 
 .post-content s, 
 .post-content samp, 
 .post-content small, 
 .post-content span, 
 .post-content strike, 
 .post-content sub, 
 .post-content sup, 
 .post-content tt, 
 .post-content var {
     border: 0;
     font-family: inherit;
     font-size: 100%;
     font-style: inherit;
     font-weight: inherit;
     margin: 0;
     outline: 0;
     padding: 0;
     vertical-align: baseline;
 }
 
 .post-content ::after,.post-content ::before {
     box-sizing: border-box;
 }
   
 .post-content > blockquote{
    padding: 1em;
    font-style: initial;
    margin: 1em 0;
    border: 0 !important;
    border-left: 0.5em cyan solid !important;  
    background-color: lightcyan;
    color: #333;
  }

 .post-content blockquote::before {
    display: none;
  }

 /* 根据用户的偏好来选择主题 */
body.light {
  background-color: #f9f9f9;
  color: #000000;
}

body.dark {
  background-color: #121212;
  color: #ffffff;
}

/* 根据用户的偏好来切换主题 */
@media (prefers-color-scheme: dark) {
  body.dark {
    display: initial;
  }
  body.light {
    display: none;
  }
 
 article {
     background-color: #262626 !important;  
     visibility: visible;
     opacity: 1;
     transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
     transition: all 0.28s ease 0s, opacity 0.8s ease-out 0s, transform 0.8s ease-out 0s;
   }
}

@media (prefers-color-scheme: light) {
  body.light {
    display: initial;
  }
  body.dark {
    display: none;
  }
}

/** @media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --block-hover: #1c1c1c;
    --text-p1: #fff;
    --text-p3: #777;
    --card: #fff;
    --waline-white: #000 !important;
    --waline-light-grey: #666 !important;
    --waline-dark-grey: #999 !important;
    --waline-text-color: #888 !important;
    --waline-bgcolor: #1e1e1e !important;
    --waline-bgcolor-light: #272727 !important;
    --waline-border-color: #333 !important;
    --waline-disable-bgcolor: #444 !important;
    --waline-disable-color: #272727 !important;
    --waline-bq-color: #272727 !important;
    --waline-info-bgcolor: #272727 !important;
    --waline-info-color: #666 !important;
  }
  :root:not([color-scheme]) fa-solid,
  :root:not([color-scheme]) fa-regular,
  :root:not([color-scheme]) fa-duotone,
  :root:not([color-scheme]) fa-light,
  :root:not([color-scheme]) fa-thin,
  :root:not([color-scheme]) fal,
  :root:not([color-scheme]) fad,
  :root:not([color-scheme]) fa,
  :root:not([color-scheme]) svg.iconfont,
  :root:not([color-scheme]) img,
  :root:not([color-scheme]) .lazyload {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .widget.blogger .content .social-wrapper a.social:hover {
    background: var(--color-card);
  }
  :root:not([color-scheme]) .widget >.content ul.entry a .badge,
  :root:not([color-scheme]) .widget >.content ul.popular-posts a .badge {
    color: unset !important;
  }
  :root:not([color-scheme]) .content {
    color: var(--color-p);
  }
  :root:not([color-scheme]) .widget >.content a {
    color: var(--color-p) !important;
  }
  :root:not([color-scheme]) .widget >.content a:hover {
    color: var(--color-list-hl) !important;
  }
  :root:not([color-scheme]) .note {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) div.tabs ul.nav-tabs li.tab.active a {
    color: var(--color-p);
    background: var(--color-card);
  }
  :root:not([color-scheme]) kbd {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .cover-wrapper.dock .menu .list-h a:hover,
  :root:not([color-scheme]) .cover-wrapper.featured .menu .list-h a:hover,
  :root:not([color-scheme]) .cover-wrapper.focus .menu .list-h a:hover {
    color: var(--color-text) !important;
  }
  :root:not([color-scheme]) .gutter {
    background: var(--color-card) !important;
    background-color: var(--color-card) !important;
  }
  :root:not([color-scheme]) .highlight figcaption {
    background-color: #14161a;
  }
  :root:not([color-scheme]) .highlight pre .line,
  :root:not([color-scheme]) .highlight pre .params {
    color: rgba(158,142,142,0.9);
  }
  :root:not([color-scheme]) *:not(.highlight) >table tr {
    background-color: var(--color-card);
  }
  :root:not([color-scheme]) *:not(.highlight) >table th {
    background: var(--color-site-bg);
  }
  :root:not([color-scheme]) *:not(.highlight) table td,
  :root:not([color-scheme]) *:not(.highlight) table th {
    border-color: var(--color-site-bg);
  }
  :root:not([color-scheme]) *:not(.highlight) >table tr:hover {
    background: var(--color-codeblock);
  }
  :root:not([color-scheme]) .timenode .highlight {
    border-color: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) blockquote p {
    color: var(--color-p);
  }
  :root:not([color-scheme]) #archive-page .archive .all-tags ul li span {
    color: var(--color-text);
    background: #6f6f72;
  }
  :root:not([color-scheme]) .btn-copy:hover {
    background: var(--color-site-body);
  }
  :root:not([color-scheme]) .aplayer {
    background: var(--color-site-bg);
  }
  :root:not([color-scheme]) .aplayer .aplayer-list ol li:hover {
    background: rgba(61,217,182,0.2);
  }
  :root:not([color-scheme]) .aplayer .aplayer-list ol li.aplayer-list-light {
    background: var(--color-block);
  }
  :root:not([color-scheme]) .aplayer-info {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .aplayer .aplayer-lrc:before {
    background: linear-gradient(180deg, #282c34 0, rgba(255,255,255,0));
  }
  :root:not([color-scheme]) .aplayer .aplayer-lrc:after {
    background: linear-gradient(180deg, rgba(0,0,0,0) 0, rgba(33,33,33,0.8));
  }
  :root:not([color-scheme]) .aplayer-pic {
    filter: brightness(70%);
  }
  :root:not([color-scheme]) .aplayer .aplayer-list ol li {
    border-top: 1px solid var(--color-card);
  }
  :root:not([color-scheme]) .aplayer.aplayer-withlist .aplayer-info {
    border-bottom: 1px solid var(--color-block);
  }
  :root:not([color-scheme]) .aplayer .aplayer-notice {
    background-color: var(--color-site-bg) !important;
  }
}
[color-scheme='dark'] {
  --block-hover: #1c1c1c;
  --text-p1: #fff;
  --text-p3: #777;
  --card: #fff;
  --waline-white: #000 !important;
  --waline-light-grey: #666 !important;
  --waline-dark-grey: #999 !important;
  --waline-text-color: #888 !important;
  --waline-bgcolor: #1e1e1e !important;
  --waline-bgcolor-light: #272727 !important;
  --waline-border-color: #333 !important;
  --waline-disable-bgcolor: #444 !important;
  --waline-disable-color: #272727 !important;
  --waline-bq-color: #272727 !important;
  --waline-info-bgcolor: #272727 !important;
  --waline-info-color: #666 !important;
}
[color-scheme='dark'] fa-solid,
[color-scheme='dark'] fa-regular,
[color-scheme='dark'] fa-duotone,
[color-scheme='dark'] fa-light,
[color-scheme='dark'] fa-thin,
[color-scheme='dark'] fal,
[color-scheme='dark'] fad,
[color-scheme='dark'] fa,
[color-scheme='dark'] svg.iconfont,
[color-scheme='dark'] img,
[color-scheme='dark'] .lazyload {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .widget.blogger .content .social-wrapper a.social:hover {
  background: var(--color-card);
}
[color-scheme='dark'] .widget >.content ul.entry a .badge,
[color-scheme='dark'] .widget >.content ul.popular-posts a .badge {
  color: unset !important;
}
[color-scheme='dark'] .content {
  color: var(--color-p);
}
[color-scheme='dark'] .widget >.content a {
  color: var(--color-p) !important;
}
[color-scheme='dark'] .widget >.content a:hover {
  color: var(--color-list-hl) !important;
}
[color-scheme='dark'] .note {
  background: var(--color-block) !important;
}
[color-scheme='dark'] div.tabs ul.nav-tabs li.tab.active a {
  color: var(--color-p);
  background: var(--color-card);
}
[color-scheme='dark'] kbd {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .cover-wrapper.dock .menu .list-h a:hover,
[color-scheme='dark'] .cover-wrapper.featured .menu .list-h a:hover,
[color-scheme='dark'] .cover-wrapper.focus .menu .list-h a:hover {
  color: var(--color-text) !important;
}
[color-scheme='dark'] .gutter {
  background: var(--color-card) !important;
  background-color: var(--color-card) !important;
}
[color-scheme='dark'] .highlight figcaption {
  background-color: #14161a;
}
[color-scheme='dark'] .highlight pre .line,
[color-scheme='dark'] .highlight pre .params {
  color: rgba(158,142,142,0.9);
}
[color-scheme='dark'] *:not(.highlight) >table tr {
  background-color: var(--color-card);
}
[color-scheme='dark'] *:not(.highlight) >table th {
  background: var(--color-site-bg);
}
[color-scheme='dark'] *:not(.highlight) table td,
[color-scheme='dark'] *:not(.highlight) table th {
  border-color: var(--color-site-bg);
}
[color-scheme='dark'] *:not(.highlight) >table tr:hover {
  background: var(--color-codeblock);
}
[color-scheme='dark'] .timenode .highlight {
  border-color: var(--color-site-bg) !important;
}
[color-scheme='dark'] blockquote p {
  color: var(--color-p);
}
[color-scheme='dark'] #archive-page .archive .all-tags ul li span {
  color: var(--color-text);
  background: #6f6f72;
}
[color-scheme='dark'] .btn-copy:hover {
  background: var(--color-site-body);
}
[color-scheme='dark'] .aplayer {
  background: var(--color-site-bg);
}
[color-scheme='dark'] .aplayer .aplayer-list ol li:hover {
  background: rgba(61,217,182,0.2);
}
[color-scheme='dark'] .aplayer .aplayer-list ol li.aplayer-list-light {
  background: var(--color-block);
}
[color-scheme='dark'] .aplayer-info {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .aplayer .aplayer-lrc:before {
  background: linear-gradient(180deg, #282c34 0, rgba(255,255,255,0));
}
[color-scheme='dark'] .aplayer .aplayer-lrc:after {
  background: linear-gradient(180deg, rgba(0,0,0,0) 0, rgba(33,33,33,0.8));
}
[color-scheme='dark'] .aplayer-pic {
  filter: brightness(70%);
}
[color-scheme='dark'] .aplayer .aplayer-list ol li {
  border-top: 1px solid var(--color-card);
}
[color-scheme='dark'] .aplayer.aplayer-withlist .aplayer-info {
  border-bottom: 1px solid var(--color-block);
}
[color-scheme='dark'] .aplayer .aplayer-notice {
  background-color: var(--color-site-bg) !important;
}**/

</style>
<footer id="footer">
    <div>
        &copy; {{ now.Format "2006" }} <a href="{{ .Site.BaseURL | absURL }}">{{ .Site.Title }} By {{ .Site.Author.name }}</a>
        {{ if .Site.Params.beian }}
        | <a rel="nofollow" target="_blank" href="http://beian.miit.gov.cn/">{{.Site.Params.beian}}</a>
        {{ end }}
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://zhangxingong.github.io/blog/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">伊桑</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>
{{ if .IsPage }}
    {{ $defaultCdnJsSite := "cdnjs.cloudflare.com" }}
    <!-- graphviz -->
    {{- if and (or .Params.graphviz.enable (and .Site.Params.graphviz.enable (ne .Params.graphviz.enable false))) (or .IsPage .IsHome) -}}
        <script type="text/javascript" src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/viz.js/1.7.1/viz.js"></script>
        <script type="text/javascript">
            (function () {
                if (!window.Viz) return;
                var vizPrefix = "language-viz-";
                var i = 0;
                Array.prototype.forEach.call(document.querySelectorAll("code[class^=" + vizPrefix + "]"), function (block) {
                    var engine;
                    block.getAttribute("class").split(" ").forEach(function (cls) {
                        if (cls.startsWith(vizPrefix)) {
                            engine = cls.substr(vizPrefix.length);
                        }
                    });
                    const rootElement = block.parentNode;
                    var image = new DOMParser().parseFromString(Viz(block.innerText, { format: "svg", engine: engine }), "image/svg+xml");
                    const container = document.createElement('div');
                    container.className = 'align-center';
                    container.setAttribute("style", "overFlow-x:auto");
                    container.appendChild(image.documentElement);
                    rootElement.parentNode.replaceChild(container, rootElement);
                });
            })();
        </script>
    {{- end -}}

    <!-- flowchart -->
    {{- if and (or .Params.flowchartDiagrams.enable (and .Site.Params.flowchartDiagrams.enable (ne .Params.flowchartDiagrams.enable false))) (or .IsPage .IsHome) -}}
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/raphael/2.2.8/raphael.min.js" crossorigin="anonymous"></script>
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/flowchart/1.12.2/flowchart.min.js" crossorigin="anonymous"></script>
        <script>
            {{- if .Params.flowchartDiagrams.options -}}
                window.flowchartDiagramsOptions = {{ .Params.flowchartDiagrams.options | safeJS }};
            {{- else if .Site.Params.flowchartDiagrams.options -}}
                window.flowchartDiagramsOptions = {{ .Site.Params.flowchartDiagrams.options | safeJS }};
            {{- end -}}
            (function () {
                if (!window.flowchart) return;
                const blocks = document.querySelectorAll('pre code.language-flowchart, pre code.language-flow');
                for (let i = 0; i < blocks.length; i++) {
                    const block = blocks[i];
                    const rootElement = block.parentNode;
                    const container = document.createElement('div');
                    const id = `js-flowchart-diagrams-${i}`;
                    container.id = id;
                    container.className = 'align-center';
                    container.setAttribute("style", "overFlow-x:auto");
                    rootElement.parentNode.replaceChild(container, rootElement);
                    const diagram = flowchart.parse(block.childNodes[0].nodeValue);
                    diagram.drawSVG(id, window.flowchartDiagramsOptions ? window.flowchartDiagramsOptions : {});
                }
            })();
        </script>
    {{- end -}}
    
    <!-- sequence必须要在flow加载之后，否则sequence渲染不成功，原因待分析 -->
    <!-- js-sequence-diagrams -->
    {{- if and (or .Params.sequenceDiagrams.enable (and .Site.Params.sequenceDiagrams.enable (ne .Params.sequenceDiagrams.enable false))) (or .IsPage .IsHome) -}}
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/webfont/1.6.28/webfontloader.js" crossorigin="anonymous"></script>
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/snap.svg/0.5.1/snap.svg-min.js" crossorigin="anonymous"></script>
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/underscore.js/1.9.1/underscore-min.js" crossorigin="anonymous"></script>
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js" crossorigin="anonymous"></script>
        <script>
        {{- if .Params.sequenceDiagrams.options -}}
            window.sequenceDiagramsOptions = {{ .Params.sequenceDiagrams.options | safeJS }};
        {{- else if .Site.Params.sequenceDiagrams.options -}}
            window.sequenceDiagramsOptions = {{ .Site.Params.sequenceDiagrams.options | safeJS }};
        {{- end -}}
        (function () {
            if (!window.Diagram) return;
            const blocks = document.querySelectorAll('pre code.language-sequence');
            for (let i = 0; i < blocks.length; i++) {
                const block = blocks[i];
                // const rootElement = window.Prism.plugins.lineNumbers ? (window.Prism.plugins.toolbar ? block.parentElement.parentElement : block.parentElement) : block;
                const rootElement = block.parentNode;
                const container = document.createElement('div');
                const id = `js-sequence-diag-${i}`;
                container.id = id;
                container.className = 'align-center';
                container.setAttribute("style", "overFlow-x:auto");
                rootElement.parentNode.replaceChild(container, rootElement);

                const diagram = Diagram.parse(block.childNodes[0].nodeValue);
                diagram.drawSVG(id, window.sequenceDiagramsOptions
                    ? window.sequenceDiagramsOptions
                    : { theme: 'simple' });
            }
        })();
        </script>
    {{- end -}}
    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    
    {{- if .Site.Params.fancybox -}}
        <script src="//{{ .Site.Params.cdnJsSite | default $defaultCdnJsSite }}/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
    {{- end -}}
{{ end }}

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='{{ "js/totop.js?v=0.0.0" | relURL }}' async></script>
{{- if hasPrefix .Site.GoogleAnalytics "UA-" -}}
    {{ template "_internal/google_analytics_async.html" . }}
{{- else if hasPrefix .Site.GoogleAnalytics "G-" -}}
    {{ template "_internal/google_analytics.html" . }}
{{- end -}}

{{ partial "copy_button" . }}

{{ if .Site.Params.busuanzi }}
    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
{{ end }}

<!-- custom js -->
{{ range .Site.Params.customJS }}
    <script src='{{ "/js/" | relURL }}{{ . }}'></script>
{{ end }}

<script src="https://immmmm.com/waterfall.min.js"></script>
<script src="https://immmmm.com/imgStatus.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  //外链 gallery 标签相册瀑布流
  var photosAll = document.getElementsByTagName('gallery') || '';
  if(photosAll){
    for(var i=0;i < photosAll.length;i++){
      photosAll[i].innerHTML = '<div class="gallery-photos">'+photosAll[i].innerHTML+'</div>'
      var photosIMG = photosAll[i].getElementsByTagName('img')
      for(var j=0;j < photosIMG.length;j++){
        wrap(photosIMG[j], document.createElement('div'));
      }
    }
  }
  function wrap(el, wrapper) {
    wrapper.className = "gallery-photo";
    el.parentNode.insertBefore(wrapper, el);
    wrapper.appendChild(el);
  }
  //相册瀑布流
  let galleryPhotos = document.querySelectorAll('.gallery-photos') || ''
  if(galleryPhotos){
    imgStatus.watch('.gallery-photo img', function(imgs) {
      if(imgs.isDone()){
        for(var i=0;i < galleryPhotos.length;i++){
          waterfall(galleryPhotos[i]);
          let pagePhoto = galleryPhotos[i].querySelectorAll('.gallery-photo');
          for(var j=0;j < pagePhoto.length;j++){pagePhoto[j].className += " visible"};
        }
      }
    });
    window.addEventListener('resize', function () {
      for(var i=0;i < galleryPhotos.length;i++){
        waterfall(galleryPhotos[i]);
      }
    });
  }
});
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
let galleryPhotos = document.querySelectorAll('.gallery-photos') || ''
if(galleryPhotos){
  imgStatus.watch('.gallery-photo img', function(imgs) {
    if(imgs.isDone()){
      for(var i=0;i < galleryPhotos.length;i++){
        waterfall(galleryPhotos[i]);
        let pagePhoto = galleryPhotos[i].querySelectorAll('.gallery-photo');
        for(var j=0;j < pagePhoto.length;j++){pagePhoto[j].className += " visible"};
      }
    }
  });
  window.addEventListener('resize', function () {
    for(var i=0;i < galleryPhotos.length;i++){
      waterfall(galleryPhotos[i]);
    }
  });
}
});
</script>

<script type="text/javascript" src="https://immmmm.com/view-image.js"></script>
<script>
  window.ViewImage && ViewImage.init('.gallery-photo img')
</script>

<canvas class="fireworks" style="position: fixed; left: 0px; top: 0px; z-index: 1; pointer-events: none; width: 1536px; height: 310px;" width="3072" height="620"></canvas>
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
<script type="text/javascript" src="/js/fireworks.js"></script>

<!-- 雪花特效 -->
<!-- script type="text/javascript" src="\js\snow.js"></script> -->
<!--动态线条背景-->
<script type="text/javascript" color="220,220,220" opacity="0.7" zindex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
<canvas id="c_n39" style="position: fixed; top: 0px; left: 0px; z-index: -2; opacity: 0.7;" width="1536" height="150"></canvas>

<script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};

function toggleTheme() {
  var body = document.body;
 // var toggleButton = document.getElementById("toggleButton");
  if (body.classList.contains("dark")) {
    body.classList.remove("dark");
  } else {
    body.classList.add("dark");
  }
 // toggleButton.innerHTML = "Toggle Black-White"; // 切换按钮文本
}

 
/**
 * 暗黑模式触发器

 function toggleTheme(){
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
 } */

/**
 * bind event for toggle button


function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings(); 
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});
volantis.pjax.push(bindToggleButton); **/

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
       setLS(darkModeStorageKey, "dark"); 
       applyCustomDarkModeSettings("dark");
    }
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
       setLS(darkModeStorageKey, "light"); 
       applyCustomDarkModeSettings("light");
    }
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>
